<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Server Restart Bar Widget</title>
    <style>
        /* Wichtig: Der Body des iFrames muss transparent sein. */
        body {
            background-color: transparent;
            font-family: sans-serif;
            color: #ffffff;
            margin: 0;
            padding: 0;
            /* Extra Padding für den Box-Shadow (nur links/rechts für die Bar) */
            padding: 10px 20px; 
            display: flex;
            justify-content: center;
        }

        /* Stil für die Haupt-Bar (nimmt die volle Breite ein) */
        .restart-bar {
            background-color: rgba(0, 0, 0, 0.9); /* Dunkler Hintergrund */
            border-radius: 8px;
            padding: 1rem 1.5rem;
            text-align: center;
            /* FEUERROT AKZENT */
            border: 3px solid #E53935; 
            
            width: 100%;
            max-width: 100%;
            
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease-in-out;
        }
        
        /* Hover-Effekt (optional, aber beibehalten) */
        .restart-bar:hover {
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.6), 
                        0 0 15px rgba(229, 57, 53, 0.7); 
        }

        /* Container für die obere Zeile (Timer + Info) */
        .info-row {
            display: flex;
            justify-content: center;
            align-items: baseline;
            flex-wrap: wrap;
            gap: 10px 20px;
        }

        /* Countdown-Wert */
        .countdown-value {
            font-size: 1.8rem;
            font-weight: 800;
            color: #E53935; /* Feuerrot */
            line-height: 1.1;
        }
        
        /* Stil für den aktiven Neustart */
        .active-restart {
            color: #388E3C; /* Grün */
            font-size: 1.8rem;
        }

        /* Feste Beschriftung */
        .timer-pre-label {
            font-size: 1rem;
            font-weight: 500;
            color: #ffffff;
            opacity: 0.9;
            text-transform: uppercase;
        }

        /* Countdown-Label (Status) */
        .countdown-label {
            font-size: 0.9rem;
            font-weight: 500;
            color: #ffffff;
            opacity: 0.7;
            text-transform: uppercase;
            margin-top: 5px;
        }
        
        /* Stil für den statischen Infotext */
        .restart-static-info {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 10px;
        }
    </style>
</head>
<body>

    <div class="restart-bar">
        
        <div class="info-row">
            
            <!-- Linke Seite: Feste Beschriftung -->
            <div class="timer-pre-label">NÄCHSTER NEUSTART IN:</div>
            
            <!-- Mitte: Der Countdown-Wert -->
            <div id="countdown-timer" class="countdown-value">--:--:--</div>

        </div>

        <!-- Die Beschreibung (zeigt den nächsten Neustart an) -->
        <div id="countdown-info" class="countdown-label"></div>
        
        <!-- Statische Information zu den Neustartzeiten (kann optional entfernt werden, da die Zeiten oben stehen) -->
        <!-- <div class="restart-static-info">
            Server Neustarts: 00:00 Uhr & 12:00 Uhr
        </div> -->
    </div>

    <script>
        const timerElement = document.getElementById('countdown-timer');
        const infoElement = document.getElementById('countdown-info');

        // Die tatsächlichen Neustartzeiten in Minuten (00:00 = 0, 12:00 = 720)
        const restartTargetMinutes = [
            0,     // 00:00 Uhr (Mitternacht)
            12 * 60 // 12:00 Uhr (Mittag)
        ];
        
        const RESTART_WINDOW_MINUTES = 30; // 30 Minuten Vorlauf für den Countdown
        const RESTART_DURATION_MINUTES = 10; // Neustart dauert 10 Minuten (00:00 bis 00:10)
        
        function updateCountdown() {
            const now = new Date();
            const todayMinutes = now.getHours() * 60 + now.getMinutes();
            const nowSeconds = now.getSeconds();
            const totalNowSeconds = todayMinutes * 60 + nowSeconds;

            let nextRestartTargetMinutes = null;
            let nextRestartTargetSeconds = null; 
            let nextRestartTimeStr = "";
            
            // 1. Finde den nächsten tatsächlichen Neustart-Zielpunkt (in Sekunden)
            for (let i = 0; i < restartTargetMinutes.length; i++) {
                const targetSeconds = restartTargetMinutes[i] * 60;
                
                if (targetSeconds > totalNowSeconds) {
                    nextRestartTargetMinutes = restartTargetMinutes[i];
                    nextRestartTargetSeconds = targetSeconds;
                    
                    const targetHours = Math.floor(nextRestartTargetMinutes / 60) % 24;
                    const targetMins = nextRestartTargetMinutes % 60;
                    nextRestartTimeStr = `${targetHours.toString().padStart(2, '0')}:${targetMins.toString().padStart(2, '0')} Uhr`;
                    break;
                }
            }
            
            // 2. Wenn der nächste Neustart am nächsten Tag liegt (z.B. nach 23:59 Uhr)
            if (nextRestartTargetSeconds === null) {
                // Der nächste Neustart ist 00:00 Uhr am nächsten Tag
                nextRestartTargetMinutes = restartTargetMinutes[0] + (24 * 60); 
                nextRestartTargetSeconds = nextRestartTargetMinutes * 60;
                nextRestartTimeStr = "00:00 Uhr";
            } else {
                 // Fügt 24 Stunden hinzu, wenn das Target bereits war, aber die Schleife es nicht erfasst hat (was nicht passieren sollte, aber als Sicherheit)
                 if (nextRestartTargetSeconds < totalNowSeconds) {
                    nextRestartTargetSeconds += (24 * 60 * 60);
                 }
            }
            
            // 3. --- PRÜFUNG DES AKTIVEN NEUSTARTS (00:00 bis 00:10) ---
            
            let isRestartActive = false;
            
            for (let i = 0; i < restartTargetMinutes.length; i++) {
                const restartStartSeconds = restartTargetMinutes[i] * 60;
                const restartEndSeconds = restartStartSeconds + (RESTART_DURATION_MINUTES * 60);

                if (totalNowSeconds >= restartStartSeconds && totalNowSeconds < restartEndSeconds) {
                    isRestartActive = true;
                    break;
                }
            }
            
            // Wenn der Neustart AKTIV ist
            if (isRestartActive) {
                timerElement.textContent = 'SERVER NEUSTART LÄUFT';
                timerElement.classList.add('active-restart');
                infoElement.textContent = `BITTE KURZ WARTEN (ca. ${RESTART_DURATION_MINUTES} MINUTEN)`;
                return;
            } else {
                timerElement.classList.remove('active-restart');
            }

            // 4. --- COUNTDOWN BERECHNUNG ---

            // Zeit bis zum Neustart-Ziel (in Sekunden)
            let secondsUntilTarget = nextRestartTargetSeconds - totalNowSeconds;
            
            // Korrektur für den seltenen Fall, dass die Zeit negativ ist
            if (secondsUntilTarget < 0) {
                 secondsUntilTarget += (24 * 60 * 60);
            }
            
            // Wenn die Zeit bis zum Neustart unter dem Countdown-Fenster liegt (30 Minuten)
            const secondsInWindow = RESTART_WINDOW_MINUTES * 60;

            if (secondsUntilTarget <= secondsInWindow && secondsUntilTarget > 0) {
                // Countdown ist aktiv (weniger als 30 Minuten bis zum Neustart)
                
                // Konvertiere Sekunden in H:M:S Format
                const hours = Math.floor(secondsUntilTarget / 3600);
                const minutes = Math.floor((secondsUntilTarget % 3600) / 60);
                const seconds = secondsUntilTarget % 60;

                const formattedTime = [hours, minutes, seconds]
                    .map(t => t.toString().padStart(2, '0'))
                    .join(':');

                timerElement.textContent = formattedTime;
                infoElement.textContent = `NUR NOCH BIS: ${nextRestartTimeStr}`;
            } else {
                // Countdown ist inaktiv (mehr als 30 Minuten entfernt)
                
                // Wir berechnen die Zeit bis zum nächsten Neustart
                const hoursUntilStart = Math.floor(secondsUntilTarget / 3600);
                const minutesUntilStart = Math.floor((secondsUntilTarget % 3600) / 60);
                const secondsUntilStart = secondsUntilTarget % 60;

                const formattedTimeUntilStart = [hoursUntilStart, minutesUntilStart, secondsUntilStart]
                    .map(t => t.toString().padStart(2, '0'))
                    .join(':');

                timerElement.textContent = formattedTimeUntilStart;
                infoElement.textContent = `NÄCHSTER NEUSTART: ${nextRestartTimeStr} (COUNTDOWN STARTET 30 MIN VORHER)`;
            }
        }

        // Starte den Countdown und aktualisiere jede Sekunde
        updateCountdown();
        setInterval(updateCountdown, 1000); 

    </script>
</body>
</html>
